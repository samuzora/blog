---
import PostsList from "@layouts/PostsList.astro"
import Card from "@components/Card.vue"
import { getCollection, getEntry } from "astro:content";

const posts = (await getCollection("blog")).sort((a, b) => b.data.date - a.data.date);

const postsByYear = posts.reduce((acc, post) => {
  const year = post.data.date.getFullYear();
  if (!acc[year]) {
    acc[year] = [];
  }
  acc[year].push(post);
  return acc;
}, {});

const latestYear = Object.keys(postsByYear)[Object.keys(postsByYear).length - 1];
const latestPosts = postsByYear[latestYear];
---

<PostsList 
  selectedYear={latestYear} 
  postsByYear={postsByYear}
/>
